"use strict";(self.webpackChunkthesis_gantt_chart=self.webpackChunkthesis_gantt_chart||[]).push([[918],{5918:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var r=s(5043),a=s(3937),l=s(5350),i=s(9144),d=s(579);const n=()=>{const{auditLog:e,loadAuditLog:t,isLoading:s,error:n,clearError:c}=(0,a.It)(),{canViewAuditLog:o}=(0,l.RI)(),[x,m]=(0,r.useState)([]),[u,g]=(0,r.useState)(""),[h,b]=(0,r.useState)("all"),[p,y]=(0,r.useState)("all"),[j,v]=(0,r.useState)(1);(0,r.useEffect)((()=>{o&&t()}),[o,t]),(0,r.useEffect)((()=>{N()}),[e,u,h,p]);const N=()=>{let t=[...e];if(u&&(t=t.filter((e=>{var t,s;return e.action.toLowerCase().includes(u.toLowerCase())||(null===(t=e.details.userId)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase()))||(null===(s=e.details.assignedBy)||void 0===s?void 0:s.toLowerCase().includes(u.toLowerCase()))}))),"all"!==h&&(t=t.filter((e=>e.action===h))),"all"!==p){const e=new Date,s=new Date;switch(p){case"today":s.setHours(0,0,0,0);break;case"week":s.setDate(e.getDate()-7);break;case"month":s.setMonth(e.getMonth()-1);break;default:s=null}s&&(t=t.filter((e=>new Date(e.timestamp)>=s)))}t.sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))),m(t),v(1)},f=e=>{switch(e){case"ROLE_ASSIGNED":return"\ud83d\udc64";case"ROLE_REMOVED":return"\u274c";case"LOGIN":return"\ud83d\udd13";case"LOGOUT":return"\ud83d\udd12";case"FILE_UPLOAD":return"\ud83d\udcc1";case"FILE_DELETE":return"\ud83d\uddd1\ufe0f";case"GANTT_EDIT":return"\ud83d\udcca";case"AUDIT_LOG_CLEARED":return"\ud83e\uddf9";default:return"\ud83d\udcdd"}},w=e=>{switch(e){case"ROLE_ASSIGNED":return"bg-green-100 text-green-800";case"ROLE_REMOVED":return"bg-red-100 text-red-800";case"LOGIN":return"bg-blue-100 text-blue-800";case"LOGOUT":default:return"bg-gray-100 text-gray-800";case"FILE_UPLOAD":return"bg-purple-100 text-purple-800";case"FILE_DELETE":return"bg-orange-100 text-orange-800";case"GANTT_EDIT":return"bg-indigo-100 text-indigo-800";case"AUDIT_LOG_CLEARED":return"bg-yellow-100 text-yellow-800"}},L=e=>e&&0!==Object.keys(e).length?Object.entries(e).map((e=>{let[t,s]=e;return`${t}: ${s}`})).join(", "):"No additional details",E=()=>[...new Set(e.map((e=>e.action)))].sort(),D=50*j,A=D-50,k=x.slice(A,D),T=Math.ceil(x.length/50),O=e=>v(e);return o?s?(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)(i.A,{}),(0,d.jsx)("p",{className:"text-center mt-4",children:"Loading audit log..."})]}):(0,d.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Audit Log"}),(0,d.jsx)("p",{className:"text-gray-600",children:"View system activities and user actions"})]}),n&&(0,d.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("p",{className:"text-red-800",children:n}),(0,d.jsx)("button",{onClick:c,className:"text-red-600 hover:text-red-800",children:"\xd7"})]})}),(0,d.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-sm",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),(0,d.jsx)("div",{className:"text-sm text-gray-600",children:"Total Events"})]}),(0,d.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-sm",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-green-600",children:x.length}),(0,d.jsx)("div",{className:"text-sm text-gray-600",children:"Filtered Events"})]}),(0,d.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-sm",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:E().length}),(0,d.jsx)("div",{className:"text-sm text-gray-600",children:"Action Types"})]})]}),(0,d.jsx)("div",{className:"mb-6 bg-white p-4 border border-gray-200 rounded-lg shadow-sm",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,d.jsx)("input",{type:"text",value:u,onChange:e=>g(e.target.value),placeholder:"Search actions, users...",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Action Type"}),(0,d.jsxs)("select",{value:h,onChange:e=>b(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"All Actions"}),E().map((e=>(0,d.jsx)("option",{value:e,children:e},e)))]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),(0,d.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,d.jsx)("option",{value:"all",children:"All Time"}),(0,d.jsx)("option",{value:"today",children:"Today"}),(0,d.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,d.jsx)("option",{value:"month",children:"Last 30 Days"})]})]})]})}),(0,d.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:(0,d.jsxs)("div",{className:"overflow-x-auto",children:[(0,d.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,d.jsx)("thead",{className:"bg-gray-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Agent"})]})}),(0,d.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map((e=>{return(0,d.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(t=e.timestamp,new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsxs)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(e.action)}`,children:[(0,d.jsx)("span",{className:"mr-1",children:f(e.action)}),e.action]})}),(0,d.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,d.jsx)("div",{className:"max-w-xs truncate",title:L(e.details),children:L(e.details)})}),(0,d.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,d.jsxs)("div",{className:"max-w-xs truncate",title:e.userAgent,children:[e.userAgent.split(" ")[0]," "]})})]},e.id);var t}))})]}),0===k.length&&(0,d.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No audit entries found matching your criteria."})]})}),T>1&&(0,d.jsx)("div",{className:"mt-6 flex justify-center",children:(0,d.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,d.jsx)("button",{onClick:()=>O(j-1),disabled:1===j,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),[...Array(T)].map(((e,t)=>{const s=t+1,r=s===j;return 1===s||s===T||s>=j-2&&s<=j+2?(0,d.jsx)("button",{onClick:()=>O(s),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium "+(r?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:s},s):s===j-3||s===j+3?(0,d.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},s):null})),(0,d.jsx)("button",{onClick:()=>O(j+1),disabled:j===T,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})})]}):(0,d.jsxs)("div",{className:"p-6 text-center",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-red-600",children:"Access Denied"}),(0,d.jsx)("p",{className:"text-gray-600",children:"You don't have permission to view the audit log."})]})}}}]);
//# sourceMappingURL=918.fdf3d988.chunk.js.map